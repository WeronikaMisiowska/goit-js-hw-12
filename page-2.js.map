{"version":3,"file":"page-2.js","sources":["../src/gallery.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n\nconst API_KEY = '45947760-a7d8d36d32b01afaf5acf1299'; \nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('#gallery');\nconst loader = document.querySelector('#loader');\n// const loadMoreBtn = document.querySelector('.load-more')\nconst loadMoreBtn = document.createElement('button');\nloadMoreBtn.textContent = 'Load more';\nloadMoreBtn.classList.add('load-more');\ndocument.body.append(loadMoreBtn); \nloadMoreBtn.style.display = 'none'; \n\nlet query = '';\nlet page = 1;\nlet perPage = 40;\nlet lightbox;\n\n\nasync function fetchImages(query, page) {\n  const URL = `https://pixabay.com/api/?key=${API_KEY}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n  \n  try {\n    loader.style.display = 'block'; \n    const response = await axios.get(URL);\n    loader.style.display = 'none'; \n    return response.data;\n  } catch (error) {\n    console.error('Błąd w zapytaniu:', error);\n    loader.style.display = 'none'; \n    iziToast.error({\n      title: 'Error',\n      message: 'Problem with fetching images',\n    });\n    return { hits: [], totalHits: 0 };\n  }\n}\n\n\nfunction displayImages(images) {\n  if (page === 1) {\n    gallery.innerHTML = '';\n    gallery.classList.remove('hidden');\n  }\n  \n  const markup = images.map(image => `\n    <a href=\"${image.largeImageURL}\" class=\"gallery-item\">\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n      <div class=\"image-info\">\n        <p><span class=\"image-info-label\">Likes:</span> <span class=\"image-info-value\">${image.likes}</span></p>\n        <p><span class=\"image-info-label\">Views:</span> <span class=\"image-info-value\">${image.views}</span></p>\n        <p><span class=\"image-info-label\">Comments:</span> <span class=\"image-info-value\">${image.comments}</span></p>\n        <p><span class=\"image-info-label\">Downloads:</span> <span class=\"image-info-value\">${image.downloads}</span></p>\n      </div>\n    </a>\n  `).join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup); \n\n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    lightbox = new SimpleLightbox('.gallery-item', { captionsData: 'alt', captionDelay: 250 });\n  }\n}\n\n\nasync function handleImagesRequest() {\n  const data = await fetchImages(query, page);\n\n  if (data.hits.length === 0 && page === 1) {\n    iziToast.info({\n      iconUrl: './src/img/no-images-icon.png',\n      message: 'Sorry, there are no images matching your search query. Please, try again!',\n      backgroundColor: '#EF4040',\n    });\n    loadMoreBtn.style.display = 'none';\n    return;\n  }\n\n  displayImages(data.hits);\n\n  if (data.hits.length < perPage || (page * perPage) >= data.totalHits) {\n    loadMoreBtn.style.display = 'none';\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    loadMoreBtn.style.display = 'block';\n  }\n\n  \n  if (page > 1) {\n    const { height: galleryItemHeight } = document.querySelector('.gallery-item').getBoundingClientRect();\n    window.scrollBy({\n      top: galleryItemHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n\n\nform.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  query = document.querySelector('#query').value.trim();\n\n  if (query) {\n    page = 1;\n    loadMoreBtn.style.display = 'none';\n    await handleImagesRequest();\n  }\n});\n\n\nloadMoreBtn.addEventListener('click', async () => {\n  page += 1; \n  await handleImagesRequest(); \n});"],"names":["API_KEY","form","gallery","loader","loadMoreBtn","query","page","perPage","lightbox","fetchImages","URL","response","axios","error","iziToast","displayImages","images","markup","image","SimpleLightbox","handleImagesRequest","data","galleryItemHeight","event"],"mappings":"sJAOA,MAAMA,EAAU,qCACVC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EAEzCC,EAAc,SAAS,cAAc,QAAQ,EACnDA,EAAY,YAAc,YAC1BA,EAAY,UAAU,IAAI,WAAW,EACrC,SAAS,KAAK,OAAOA,CAAW,EAChCA,EAAY,MAAM,QAAU,OAE5B,IAAIC,EAAQ,GACRC,EAAO,EACPC,EAAU,GACVC,EAGJ,eAAeC,EAAYJ,EAAOC,EAAM,CACtC,MAAMI,EAAM,gCAAgCV,CAAO,MAAM,mBAAmBK,CAAK,CAAC,iEAAiEC,CAAI,aAAaC,CAAO,GAE3K,GAAI,CACFJ,EAAO,MAAM,QAAU,QACvB,MAAMQ,EAAW,MAAMC,EAAM,IAAIF,CAAG,EACpC,OAAAP,EAAO,MAAM,QAAU,OAChBQ,EAAS,IACjB,OAAQE,EAAO,CACd,eAAQ,MAAM,oBAAqBA,CAAK,EACxCV,EAAO,MAAM,QAAU,OACvBW,EAAS,MAAM,CACb,MAAO,QACP,QAAS,8BACf,CAAK,EACM,CAAE,KAAM,CAAA,EAAI,UAAW,CAAC,CAChC,CACH,CAGA,SAASC,EAAcC,EAAQ,CACzBV,IAAS,IACXJ,EAAQ,UAAY,GACpBA,EAAQ,UAAU,OAAO,QAAQ,GAGnC,MAAMe,EAASD,EAAO,IAAIE,GAAS;AAAA,eACtBA,EAAM,aAAa;AAAA,kBAChBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA,yFAEiCA,EAAM,KAAK;AAAA,yFACXA,EAAM,KAAK;AAAA,4FACRA,EAAM,QAAQ;AAAA,6FACbA,EAAM,SAAS;AAAA;AAAA;AAAA,GAGzG,EAAE,KAAK,EAAE,EAEVhB,EAAQ,mBAAmB,YAAae,CAAM,EAE1CT,EACFA,EAAS,QAAO,EAEhBA,EAAW,IAAIW,EAAe,gBAAiB,CAAE,aAAc,MAAO,aAAc,GAAG,CAAE,CAE7F,CAGA,eAAeC,GAAsB,CACnC,MAAMC,EAAO,MAAMZ,EAAYJ,EAAOC,CAAI,EAE1C,GAAIe,EAAK,KAAK,SAAW,GAAKf,IAAS,EAAG,CACxCQ,EAAS,KAAK,CACZ,QAAS,+BACT,QAAS,4EACT,gBAAiB,SACvB,CAAK,EACDV,EAAY,MAAM,QAAU,OAC5B,MACD,CAcD,GAZAW,EAAcM,EAAK,IAAI,EAEnBA,EAAK,KAAK,OAASd,GAAYD,EAAOC,GAAYc,EAAK,WACzDjB,EAAY,MAAM,QAAU,OAC5BU,EAAS,KAAK,CACZ,QAAS,4DACf,CAAK,GAEDV,EAAY,MAAM,QAAU,QAI1BE,EAAO,EAAG,CACZ,KAAM,CAAE,OAAQgB,GAAsB,SAAS,cAAc,eAAe,EAAE,wBAC9E,OAAO,SAAS,CACd,IAAKA,EAAoB,EACzB,SAAU,QAChB,CAAK,CACF,CACH,CAGArB,EAAK,iBAAiB,SAAU,MAAOsB,GAAU,CAC/CA,EAAM,eAAc,EACpBlB,EAAQ,SAAS,cAAc,QAAQ,EAAE,MAAM,OAE3CA,IACFC,EAAO,EACPF,EAAY,MAAM,QAAU,OAC5B,MAAMgB,EAAmB,EAE7B,CAAC,EAGDhB,EAAY,iBAAiB,QAAS,SAAY,CAChDE,GAAQ,EACR,MAAMc,EAAmB,CAC3B,CAAC"}